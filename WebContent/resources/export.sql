--------------------------------------------------------
-- Archivo creado  - martes-febrero-21-2017   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table CITA
--------------------------------------------------------

  CREATE TABLE "CPCDB"."CITA" 
   (	"ID_CITA" NUMBER(8,0), 
	"SALON" VARCHAR2(50 BYTE), 
	"FECHA_SOLICITUD" TIMESTAMP (6), 
	"FECHA_CITA" TIMESTAMP (6), 
	"ID_PRACTICANTE" NUMBER(8,0), 
	"ID_PACIENTE" NUMBER(8,0), 
	"ESTADO" VARCHAR2(50 BYTE) DEFAULT 'creada', 
	"ID_TRATAMIENTO" NUMBER(8,0) DEFAULT 0, 
	"ID_REPORTE" NUMBER(8,0) DEFAULT 0, 
	"ES_VALORACION" NUMBER DEFAULT 0, 
	"NUM_CITA" NUMBER DEFAULT 0
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table CUPOS
--------------------------------------------------------

  CREATE TABLE "CPCDB"."CUPOS" 
   (	"NUMERO" NUMBER DEFAULT 7
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table EPS
--------------------------------------------------------

  CREATE TABLE "CPCDB"."EPS" 
   (	"ID_EPS" NUMBER(8,0), 
	"NOMBRE_EPS" VARCHAR2(200 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table HISTORIA_CLINICA
--------------------------------------------------------

  CREATE TABLE "CPCDB"."HISTORIA_CLINICA" 
   (	"ID_HISTORIA" NUMBER, 
	"ID_PACIENTE" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PERFIL
--------------------------------------------------------

  CREATE TABLE "CPCDB"."PERFIL" 
   (	"ID_PERFIL" NUMBER(8,0), 
	"NOMBRE_PERFIL" VARCHAR2(100 BYTE), 
	"PERMISO" VARCHAR2(100 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PERSONA
--------------------------------------------------------

  CREATE TABLE "CPCDB"."PERSONA" 
   (	"ID_PERSONA" NUMBER(8,0), 
	"PRIMER_NOMBRE" VARCHAR2(200 BYTE), 
	"SEGUNDO_NOMBRE" VARCHAR2(200 BYTE), 
	"PRIMER_APELLIDO" VARCHAR2(200 BYTE), 
	"SEGUNDO_APELLIDO" VARCHAR2(200 BYTE), 
	"NUMERO_DOCUMENTO" VARCHAR2(200 BYTE), 
	"DIRECCION" VARCHAR2(200 BYTE), 
	"TELEFONO" NUMBER(12,0), 
	"TIPO_DOCUMENTO_ID_DOCUMENTO" NUMBER(8,0), 
	"EPS_ID_EPS" NUMBER(8,0), 
	"PERSONA_ID_SUPERIOR" NUMBER(8,0), 
	"PERFIL_ID_PERFIL" NUMBER(8,0), 
	"PERSONA_ID_PERSONA" NUMBER(8,0), 
	"USUARIO" VARCHAR2(30 BYTE), 
	"PASS" VARCHAR2(30 BYTE), 
	"CORREO" VARCHAR2(100 BYTE), 
	"OTRO_TEL" NUMBER(12,0) DEFAULT 0, 
	"CODIGO" NUMBER(12,0) DEFAULT 0, 
	"JORNADA" VARCHAR2(20 BYTE) DEFAULT 'dia'
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table REPORTE_SESION
--------------------------------------------------------

  CREATE TABLE "CPCDB"."REPORTE_SESION" 
   (	"ID_SESION" NUMBER, 
	"CITA_ID_CITA" NUMBER, 
	"FECHA" TIMESTAMP (6), 
	"NOMBRE_PROFESIONAL" VARCHAR2(50 BYTE), 
	"OBJETIVO_SESION" VARCHAR2(500 BYTE), 
	"DESCRIPCION_SESION" VARCHAR2(500 BYTE), 
	"TAREAS_ASIGNADAS" VARCHAR2(500 BYTE), 
	"ACTIVIDADES_PROX_SESION" VARCHAR2(500 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table TIPO_DOCUMENTO
--------------------------------------------------------

  CREATE TABLE "CPCDB"."TIPO_DOCUMENTO" 
   (	"ID_DOCUMENTO" NUMBER(8,0), 
	"SIGLA" VARCHAR2(5 BYTE), 
	"NOMBRE_DOCUMENTO" VARCHAR2(100 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table TRATAMIENTO
--------------------------------------------------------

  CREATE TABLE "CPCDB"."TRATAMIENTO" 
   (	"ID_TRATAMIENTO" NUMBER(8,0), 
	"ID_PACIENTE" NUMBER(8,0), 
	"ESTADO" VARCHAR2(20 BYTE) DEFAULT 'valoracion', 
	"FECHA_INICIO" TIMESTAMP (6), 
	"FECHA_CIERRE" TIMESTAMP (6), 
	"TIPO" VARCHAR2(20 BYTE) DEFAULT 'individual'
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Sequence CITA_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."CITA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence DOCUMENTO_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."DOCUMENTO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence EPS_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."EPS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence HISTORIA_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."HISTORIA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence PACIENTE_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."PACIENTE_SEQ"  MINVALUE 10000 MAXVALUE 999999999999 INCREMENT BY 1 START WITH 100035 NOCACHE  NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence PERFIL_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."PERFIL_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence PERSONA_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."PERSONA_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 201 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence REPORTE_CITA_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."REPORTE_CITA_SEQ"  MINVALUE 1 MAXVALUE 99999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 ORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence REPORTE_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."REPORTE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence REPORTE_SESION_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."REPORTE_SESION_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence TIPO_DOCUMENTO_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."TIPO_DOCUMENTO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence TRATAMIENTO_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."TRATAMIENTO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence USUARIO_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CPCDB"."USUARIO_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
REM INSERTING into CPCDB.CITA
SET DEFINE OFF;
REM INSERTING into CPCDB.CUPOS
SET DEFINE OFF;
Insert into CPCDB.CUPOS (NUMERO) values ('4');
REM INSERTING into CPCDB.EPS
SET DEFINE OFF;
Insert into CPCDB.EPS (ID_EPS,NOMBRE_EPS) values ('0','No Aplica');
Insert into CPCDB.EPS (ID_EPS,NOMBRE_EPS) values ('201','Compensar');
Insert into CPCDB.EPS (ID_EPS,NOMBRE_EPS) values ('202','Colsanitas');
Insert into CPCDB.EPS (ID_EPS,NOMBRE_EPS) values ('203','Saludcop');
REM INSERTING into CPCDB.HISTORIA_CLINICA
SET DEFINE OFF;
REM INSERTING into CPCDB.PERFIL
SET DEFINE OFF;
Insert into CPCDB.PERFIL (ID_PERFIL,NOMBRE_PERFIL,PERMISO) values ('1','Administrador',null);
Insert into CPCDB.PERFIL (ID_PERFIL,NOMBRE_PERFIL,PERMISO) values ('2','Supervisor',null);
Insert into CPCDB.PERFIL (ID_PERFIL,NOMBRE_PERFIL,PERMISO) values ('3','Practicante',null);
Insert into CPCDB.PERFIL (ID_PERFIL,NOMBRE_PERFIL,PERMISO) values ('4','Paciente',null);
REM INSERTING into CPCDB.PERSONA
SET DEFINE OFF;
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('161','Camilo',null,'Suarez','Villalba','1','calle falsa 123','123','1','203','0','4',null,null,'123','a@b.com','123','0','tarde');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('1','Sebasti?n',null,'Gil','Parga','1015425362','Calle falsa 123','123','1','0','0','1',null,null,'123','a@b.com','123','123','manana');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('141','Pedro','Enrique','Perez','Rincon','1234','calle verdadera 123','12345','1','0','0','3',null,null,'123','a@bcdef.com','123','123456','manana');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('142','Juana','Valentina','Gonzales','Carrillo','123','calle falsa 123','123','2','202','183','4',null,null,'123','a@b.com','123','0','manana');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('181','Juan','Manuel','Pachón','Vargas','1020757355','Cra. 54D # 188 - 18 Int. 4 Apto. 301','3192686688','1','0','0','1',null,null,'123','juanm.pachonv@gmail.com','3192686688','0','manana');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('182','Andres','Camilo','Gonzalez','Ramirez','48975364','Calle falsa 456','55555555','1','202','0','4',null,null,'123','andres@localhost.com','31958877744','0','tarde');
Insert into CPCDB.PERSONA (ID_PERSONA,PRIMER_NOMBRE,SEGUNDO_NOMBRE,PRIMER_APELLIDO,SEGUNDO_APELLIDO,NUMERO_DOCUMENTO,DIRECCION,TELEFONO,TIPO_DOCUMENTO_ID_DOCUMENTO,EPS_ID_EPS,PERSONA_ID_SUPERIOR,PERFIL_ID_PERFIL,PERSONA_ID_PERSONA,USUARIO,PASS,CORREO,OTRO_TEL,CODIGO,JORNADA) values ('183','Miguel','Andres','Rincon','Díaz','999','Calle falsa 789','7777777','1','0','0','3',null,null,'123','michel@localhost.com','3109999999','506888777','tarde');
REM INSERTING into CPCDB.REPORTE_SESION
SET DEFINE OFF;
REM INSERTING into CPCDB.TIPO_DOCUMENTO
SET DEFINE OFF;
Insert into CPCDB.TIPO_DOCUMENTO (ID_DOCUMENTO,SIGLA,NOMBRE_DOCUMENTO) values ('1','CC','Cedula de Ciudadan?a');
Insert into CPCDB.TIPO_DOCUMENTO (ID_DOCUMENTO,SIGLA,NOMBRE_DOCUMENTO) values ('2','TI','Tarjeta de Identidad');
Insert into CPCDB.TIPO_DOCUMENTO (ID_DOCUMENTO,SIGLA,NOMBRE_DOCUMENTO) values ('3','CE','Cedula de Extranjeria');
Insert into CPCDB.TIPO_DOCUMENTO (ID_DOCUMENTO,SIGLA,NOMBRE_DOCUMENTO) values ('4','RC','Registro Civ?l');
REM INSERTING into CPCDB.TRATAMIENTO
SET DEFINE OFF;
--------------------------------------------------------
--  DDL for Index PERSONA_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."PERSONA_PK" ON "CPCDB"."PERSONA" ("ID_PERSONA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index CITA_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."CITA_PK" ON "CPCDB"."CITA" ("ID_CITA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index SESION_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."SESION_PK" ON "CPCDB"."REPORTE_SESION" ("ID_SESION") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index CUPOS_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."CUPOS_PK" ON "CPCDB"."CUPOS" ("NUMERO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index TIPO_DOCUMENTO_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."TIPO_DOCUMENTO_PK" ON "CPCDB"."TIPO_DOCUMENTO" ("ID_DOCUMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index PERFIL_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."PERFIL_PK" ON "CPCDB"."PERFIL" ("ID_PERFIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index TRATAMIENTO_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."TRATAMIENTO_PK" ON "CPCDB"."TRATAMIENTO" ("ID_TRATAMIENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index HISTORIA_CLINICA_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."HISTORIA_CLINICA_PK" ON "CPCDB"."HISTORIA_CLINICA" ("ID_HISTORIA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index EPS_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CPCDB"."EPS_PK" ON "CPCDB"."EPS" ("ID_EPS") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Function CUSTOM_AUTH
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CPCDB"."CUSTOM_AUTH" (p_username in VARCHAR2, p_password in VARCHAR2)
return BOOLEAN
is
  l_password varchar2(4000);
  l_stored_password varchar2(4000);
  l_expires_on date;
  l_count number;
begin
-- First, check to see if the user is in the user table
select count(*) into l_count from demo_users where user_name = p_username;
if l_count > 0 then
  -- First, we fetch the stored hashed password & expire date
  select password, expires_on into l_stored_password, l_expires_on
   from demo_users where user_name = p_username;

  -- Next, we check to see if the user's account is expired
  -- If it is, return FALSE
  if l_expires_on > sysdate or l_expires_on is null then

    -- If the account is not expired, we have to apply the custom hash
    -- function to the password
    l_password := custom_hash(p_username, p_password);

    -- Finally, we compare them to see if they are the same and return
    -- either TRUE or FALSE
    if l_password = l_stored_password then
      return true;
    else
      return false;
    end if;
  else
    return false;
  end if;
else
  -- The username provided is not in the DEMO_USERS table
  return false;
end if;
end;

/
--------------------------------------------------------
--  DDL for Function CUSTOM_HASH
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CPCDB"."CUSTOM_HASH" (p_username in varchar2, p_password in varchar2)
return varchar2
is
  l_password varchar2(4000);
  l_salt varchar2(4000) := 'BBCXDLDDKDMSHUSGINDARXMEC26KIZ';
begin

-- This function should be wrapped, as the hash algorhythm is exposed here.
-- You can change the value of l_salt or the method of which to call the
-- DBMS_OBFUSCATOIN toolkit, but you much reset all of your passwords
-- if you choose to do this.

l_password := utl_raw.cast_to_raw(dbms_obfuscation_toolkit.md5
  (input_string => p_password || substr(l_salt,10,13) || p_username ||
    substr(l_salt, 4,10)));
return l_password;
end;

/
--------------------------------------------------------
--  Constraints for Table REPORTE_SESION
--------------------------------------------------------

  ALTER TABLE "CPCDB"."REPORTE_SESION" MODIFY ("ID_SESION" NOT NULL ENABLE);
  ALTER TABLE "CPCDB"."REPORTE_SESION" ADD CONSTRAINT "SESION_PK" PRIMARY KEY ("ID_SESION")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table HISTORIA_CLINICA
--------------------------------------------------------

  ALTER TABLE "CPCDB"."HISTORIA_CLINICA" MODIFY ("ID_HISTORIA" NOT NULL ENABLE);
  ALTER TABLE "CPCDB"."HISTORIA_CLINICA" ADD CONSTRAINT "HISTORIA_CLINICA_PK" PRIMARY KEY ("ID_HISTORIA")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table TRATAMIENTO
--------------------------------------------------------

  ALTER TABLE "CPCDB"."TRATAMIENTO" ADD CONSTRAINT "TRATAMIENTO_PK" PRIMARY KEY ("ID_TRATAMIENTO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "CPCDB"."TRATAMIENTO" MODIFY ("ID_TRATAMIENTO" NOT NULL ENABLE);
